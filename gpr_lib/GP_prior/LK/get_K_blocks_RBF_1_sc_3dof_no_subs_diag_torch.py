import torch

def get_K_blocks_RBF_1_sc_3dof_no_subs(X1, X2, pos_indices, vel_indices, acc_indices, lL, sL):

    q_i1 = X1[:,pos_indices[0]:pos_indices[0]+1]
    dq_i1 = X1[:,vel_indices[0]:vel_indices[0]+1]
    ddq_i1 = X1[:,acc_indices[0]:acc_indices[0]+1]
    q_j1 = X2[:,pos_indices[0]:pos_indices[0]+1]
    dq_j1 = X2[:,vel_indices[0]:vel_indices[0]+1]
    ddq_j1 = X2[:,acc_indices[0]:acc_indices[0]+1]
    q_i2 = X1[:,pos_indices[1]:pos_indices[1]+1]
    dq_i2 = X1[:,vel_indices[1]:vel_indices[1]+1]
    ddq_i2 = X1[:,acc_indices[1]:acc_indices[1]+1]
    q_j2 = X2[:,pos_indices[1]:pos_indices[1]+1]
    dq_j2 = X2[:,vel_indices[1]:vel_indices[1]+1]
    ddq_j2 = X2[:,acc_indices[1]:acc_indices[1]+1]
    q_i3 = X1[:,pos_indices[2]:pos_indices[2]+1]
    dq_i3 = X1[:,vel_indices[2]:vel_indices[2]+1]
    ddq_i3 = X1[:,acc_indices[2]:acc_indices[2]+1]
    q_j3 = X2[:,pos_indices[2]:pos_indices[2]+1]
    dq_j3 = X2[:,vel_indices[2]:vel_indices[2]+1]
    ddq_j3 = X2[:,acc_indices[2]:acc_indices[2]+1]

    lL1 = lL[0]
    lL4 = lL[3]
    lL7 = lL[6]
    lL2 = lL[1]
    lL5 = lL[4]
    lL8 = lL[7]
    lL3 = lL[2]
    lL6 = lL[5]
    lL9 = lL[8]

    
    x0 = torch.sin(q_i1)
    x1 = torch.sin(q_j1)
    x2 = lL1**(-2.0)
    x3 = torch.cos(q_i1)
    x4 = torch.cos(q_j1)
    x5 = lL4**(-2.0)
    x6 = lL7**(-2.0)
    x7 = dq_i1 - dq_j1
    x8 = x0*x1*x2 + x3*x4*x5
    x9 = dq_i2 - dq_j2
    x10 = lL8**(-2.0)
    x11 = ddq_i2*x10
    x12 = x11*x9
    x13 = x12*x7
    x14 = x0 - x1
    x15 = x14*x5
    x16 = x3 - x4
    x17 = x16*x2
    x18 = -x1*x17 + x15*x4
    x19 = 4*x18*x6
    x20 = dq_i3 - dq_j3
    x21 = lL9**(-2.0)
    x22 = ddq_i3*x21
    x23 = x20*x22
    x24 = x19*x7
    x25 = x7**2
    x26 = x25*x6
    x27 = 2*x26
    x28 = -x27
    x29 = -x0*x17 + x15*x3
    x30 = 2*x29
    x31 = x18*x30
    x32 = dq_i1*x7
    x33 = x29*x32
    x34 = torch.sin(q_i2)
    x35 = torch.sin(q_j2)
    x36 = x34 - x35
    x37 = lL5**(-2.0)
    x38 = torch.cos(q_i2)
    x39 = x37*x38
    x40 = torch.cos(q_j2)
    x41 = x38 - x40
    x42 = lL2**(-2.0)
    x43 = x34*x42
    x44 = x36*x39 - x41*x43
    x45 = dq_i2*x44
    x46 = torch.sin(q_i3)
    x47 = torch.sin(q_j3)
    x48 = x46 - x47
    x49 = lL6**(-2.0)
    x50 = torch.cos(q_i3)
    x51 = x49*x50
    x52 = torch.cos(q_j3)
    x53 = x50 - x52
    x54 = lL3**(-2.0)
    x55 = x46*x54
    x56 = x48*x51 - x53*x55
    x57 = dq_i3*x56
    x58 = x30*x9
    x59 = 2*x23
    x60 = x9**2
    x61 = x10*x60
    x62 = 4*x26
    x63 = x61*x62
    x64 = dq_i1*x29
    x65 = x62*x9
    x66 = -x9
    x67 = 2*x66
    x68 = x28 + 3
    x69 = -x7
    x70 = ddq_i1*x6
    x71 = x68*x69*x70
    x72 = 2*x61
    x73 = 2*x44
    x74 = dq_i2*x73
    x75 = 2*x56
    x76 = dq_i3*x75
    x77 = ddq_i2*x72 - ddq_i2 + dq_i1*x58 + x74*x9 + x76*x9
    x78 = 2*x6
    x79 = x20*x30
    x80 = 2*x20
    x81 = x20**2
    x82 = x21*x81
    x83 = ddq_i3*x82
    x84 = x20*x62
    x85 = -x20
    x86 = 2*x82
    x87 = ddq_i3*x86 - ddq_i3 + dq_i1*x79 + x20*x74 + x20*x76
    x88 = ddq_j3*x21
    x89 = x69**2
    x90 = 4/lL7**4
    x91 = x7**3*x90
    x92 = 6*x6
    x93 = x7*x92
    x94 = -x35*x41*x42 + x36*x37*x40
    x95 = 2*x94
    x96 = x23*x95
    x97 = x35*x43 + x39*x40
    x98 = dq_i2*x97
    x99 = x7*x70
    x100 = x95*x99
    x101 = -dq_i2*x97
    x102 = dq_i1*x30*x94
    x103 = x73*x94
    x104 = dq_i2*x103
    x105 = x76*x94
    x106 = x12*x95
    x107 = x101 + x102 + x104 + x105 + x106
    x108 = -x47*x53*x54 + x48*x49*x52
    x109 = 2*x108
    x110 = x109*x12
    x111 = x47*x55 + x51*x52
    x112 = dq_i3*x111
    x113 = x109*x99
    x114 = -dq_i3*x111
    x115 = dq_i1*x108*x30
    x116 = x108*x74
    x117 = x108*x75
    x118 = dq_i3*x117
    x119 = x109*x23
    x120 = x114 + x115 + x116 + x118 + x119
    x121 = -dq_i1*x8
    x122 = dq_i1*x8
    x123 = 2*x18
    x124 = x12*x123
    x125 = x123*x23
    x126 = x123*x7*x70
    x127 = dq_i1*x31
    x128 = x18*x74
    x129 = x18*x76
    x130 = 2*sL*torch.exp(-x14**2*x5 - x16**2*x2 - x26 - x36**2*x37 - x41**2*x42 - x48**2*x49 - x53**2*x54 - x61 - x82)
    x131 = x10*x9
    x132 = 4*x131*x94
    x133 = -x72
    x134 = x73*x9
    x135 = x59*x7
    x136 = x133 + 3
    x137 = 2*x13
    x138 = 4*x61
    x139 = x138*x7
    x140 = -ddq_i1*x27 + ddq_i1 - x30*x32 - x7*x74 - x7*x76
    x141 = x138*x20
    x142 = x67*x85
    x143 = 2*x10
    x144 = x66**2
    x145 = 4/lL8**4
    x146 = x145*x9**3
    x147 = 6*x64
    x148 = 6*x131
    x149 = ddq_j2*x143
    x150 = x121 + x126 + x127 + x128 + x129
    x151 = x20*x21
    x152 = 4*x108*x151
    x153 = -x86
    x154 = x20*x75
    x155 = x153 + 3
    x156 = 4*x82
    x157 = x156*x7
    x158 = x9*x99
    x159 = x156*x9
    x160 = x85**2
    x161 = 4/lL9**4
    x162 = x161*x20**3
    x163 = 6*x151
    
    K_block_list = []
    K_block_list.append(x130*(2*ddq_i1*x18*x6*(x28 + 1) - ddq_j1*x78*(-x12*x91 + x12*x93 - x23*x91 + x23*x93 - x26*x30 + x29 + x33*x92 - x45*x91 + x45*x93 - x57*x91 + x57*x93 - x64*x91 + x70*(-x25*x89*x90 + 10*x6*x89 - x68)) - ddq_j2*x10*x78*(ddq_i2*x27 - ddq_i2*x63 - x23*x65 - x45*x65 - x57*x65 - x58*x7 + x59*x9 - x64*x65 + x67*x71 + x77) + 2*dq_i1*x6*x7*x8 + 2*dq_j1*x6*(4*ddq_i2*x10*x18*x25*x6*x9 + 4*ddq_i3*x18*x20*x21*x25*x6 + 4*dq_i1*x18*x25*x29*x6 + 4*dq_i2*x18*x25*x44*x6 + 4*dq_i3*x18*x25*x56*x6 - x121 - x122*x27 - x124 - x125 - x126*x68 - x127 - x128 - x129 + 2*x18*x29*x7 - x7*x8) + 2*dq_j2*x6*(4*ddq_i2*x10*x25*x6*x9*x94 + 4*ddq_i3*x20*x21*x25*x6*x94 + 4*dq_i1*x25*x29*x6*x94 + 4*dq_i2*x25*x44*x6*x94 + 4*dq_i3*x25*x56*x6*x94 - x100*x68 - x107 - x27*x98 + 2*x29*x7*x94 - x96) + 2*dq_j3*x6*(4*ddq_i2*x10*x108*x25*x6*x9 + 4*ddq_i3*x108*x20*x21*x25*x6 + 4*dq_i1*x108*x25*x29*x6 + 4*dq_i2*x108*x25*x44*x6 + 4*dq_i3*x108*x25*x56*x6 + 2*x108*x29*x7 - x110 - x112*x27 - x113*x68 - x120) + x0*x1*x2 - x13*x19 - x19*x33 - x23*x24 - x24*x45 - x24*x57 + x3*x4*x5 - x31 - x78*x88*(ddq_i3*x27 + x12*x80 - x12*x84 - x45*x84 - x57*x84 - x62*x83 - x64*x84 - x7*x79 + 2*x71*x85 + x87)))
    K_block_list.append(x130*(2*ddq_i2*x10*x94*(x133 + 1) + 2*ddq_j1*x10*x6*(ddq_i1*x63 - ddq_i1*x72 + x134*x7 - x135 - x136*x137 + x138*x33 + x139*x23 + x139*x45 + x139*x57 + x140) + 2*dq_i2*x10*x9*x97 + 2*dq_j1*x10*(4*ddq_i1*x10*x18*x6*x60*x7 + 4*ddq_i3*x10*x18*x20*x21*x60 + 4*dq_i1*x10*x18*x29*x60 + 4*dq_i2*x10*x18*x44*x60 + 4*dq_i3*x10*x18*x56*x60 - x122*x72 - x124*x136 - x125 - x150 + 2*x18*x44*x9) + 2*dq_j2*x10*(4*ddq_i1*x10*x6*x60*x7*x94 + 4*ddq_i3*x10*x20*x21*x60*x94 + 4*dq_i1*x10*x29*x60*x94 + 4*dq_i2*x10*x44*x60*x94 + 4*dq_i3*x10*x56*x60*x94 - x100 - x101 - x102 - x104 - x105 - x106*x136 + 2*x44*x9*x94 - x72*x98 - x9*x97 - x96) + 2*dq_j3*x10*(4*ddq_i1*x10*x108*x6*x60*x7 + 4*ddq_i3*x10*x108*x20*x21*x60 + 4*dq_i1*x10*x108*x29*x60 + 4*dq_i2*x10*x108*x44*x60 + 4*dq_i3*x10*x108*x56*x60 + 2*x108*x44*x9 - x110*x136 - x112*x72 - x113 - x120) - x103 - x132*x23 - x132*x45 - x132*x57 - x132*x64 - x132*x99 - x143*x88*(ddq_i3*x72 + x11*x136*x142 - x134*x20 - x138*x83 - x141*x45 - x141*x57 - x141*x64 - x141*x99 + x80*x99 + x87) - x149*(x11*(10*x10*x144 - x136 - x144*x145*x60) + x131*x147 - x146*x23 - x146*x45 - x146*x57 - x146*x64 - x146*x99 + x148*x23 + x148*x45 + x148*x57 + x148*x99 + x44 - x61*x73) + x34*x35*x42 + x37*x38*x40))
    K_block_list.append(x130*(2*ddq_i3*x108*x21*(x153 + 1) + 2*ddq_j1*x21*x6*(ddq_i1*x62*x82 - ddq_i1*x86 + x13*x156 - x135*x155 - x137 + x140 + x154*x7 + x156*x33 + x157*x45 + x157*x57) - 2*ddq_j3*x21*(-x12*x162 + x12*x163 + x147*x151 - x162*x45 - x162*x57 - x162*x64 - x162*x99 + x163*x45 + x163*x57 + x163*x99 + x22*(-x155 - x160*x161*x81 + 10*x160*x21) + x56 - x75*x82) + 2*dq_i3*x111*x20*x21 + 2*dq_j1*x21*(4*ddq_i1*x18*x21*x6*x7*x81 + 4*ddq_i2*x10*x18*x21*x81*x9 + 4*dq_i1*x18*x21*x29*x81 + 4*dq_i2*x18*x21*x44*x81 + 4*dq_i3*x18*x21*x56*x81 - x122*x86 - x124 - x125*x155 - x150 + 2*x18*x20*x56) + 2*dq_j2*x21*(4*ddq_i1*x21*x6*x7*x81*x94 + 4*ddq_i2*x10*x21*x81*x9*x94 + 4*dq_i1*x21*x29*x81*x94 + 4*dq_i2*x21*x44*x81*x94 + 4*dq_i3*x21*x56*x81*x94 - x100 - x107 - x155*x96 + 2*x20*x56*x94 - x86*x98) + 2*dq_j3*x21*(4*ddq_i1*x108*x21*x6*x7*x81 + 4*ddq_i2*x10*x108*x21*x81*x9 + 4*dq_i1*x108*x21*x29*x81 + 4*dq_i2*x108*x21*x44*x81 + 4*dq_i3*x108*x21*x56*x81 + 2*x108*x20*x56 - x110 - x111*x20 - x112*x86 - x113 - x114 - x115 - x116 - x118 - x119*x155) - x117 - x12*x152 - x149*x21*(-ddq_i2*x138*x82 + ddq_i2*x86 + x142*x155*x22 - x154*x9 - x156*x158 + 2*x158 - x159*x45 - x159*x57 - x159*x64 + x77) - x152*x45 - x152*x57 - x152*x64 - x152*x99 + x46*x47*x54 + x49*x50*x52))
    
    return K_block_list

