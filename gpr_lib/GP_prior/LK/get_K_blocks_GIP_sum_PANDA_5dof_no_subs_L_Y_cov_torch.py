import torch

def get_K_blocks_GIP_sum_PANDA_5dof_no_subs(X1, X2, pos_indices, vel_indices, acc_indices, sigma_kin_vel_list, sigma_kin_pos_list, sigma_pot_list):

    q_i1 = X1[:,pos_indices[0]:pos_indices[0]+1]
    dq_i1 = X1[:,vel_indices[0]:vel_indices[0]+1]
    ddq_i1 = X1[:,acc_indices[0]:acc_indices[0]+1]
    q_j1 = X2[:,pos_indices[0]:pos_indices[0]+1].transpose(1,0)
    dq_j1 = X2[:,vel_indices[0]:vel_indices[0]+1].transpose(1,0)
    ddq_j1 = X2[:,acc_indices[0]:acc_indices[0]+1].transpose(1,0)
    q_i2 = X1[:,pos_indices[1]:pos_indices[1]+1]
    dq_i2 = X1[:,vel_indices[1]:vel_indices[1]+1]
    ddq_i2 = X1[:,acc_indices[1]:acc_indices[1]+1]
    q_j2 = X2[:,pos_indices[1]:pos_indices[1]+1].transpose(1,0)
    dq_j2 = X2[:,vel_indices[1]:vel_indices[1]+1].transpose(1,0)
    ddq_j2 = X2[:,acc_indices[1]:acc_indices[1]+1].transpose(1,0)
    q_i3 = X1[:,pos_indices[2]:pos_indices[2]+1]
    dq_i3 = X1[:,vel_indices[2]:vel_indices[2]+1]
    ddq_i3 = X1[:,acc_indices[2]:acc_indices[2]+1]
    q_j3 = X2[:,pos_indices[2]:pos_indices[2]+1].transpose(1,0)
    dq_j3 = X2[:,vel_indices[2]:vel_indices[2]+1].transpose(1,0)
    ddq_j3 = X2[:,acc_indices[2]:acc_indices[2]+1].transpose(1,0)
    q_i4 = X1[:,pos_indices[3]:pos_indices[3]+1]
    dq_i4 = X1[:,vel_indices[3]:vel_indices[3]+1]
    ddq_i4 = X1[:,acc_indices[3]:acc_indices[3]+1]
    q_j4 = X2[:,pos_indices[3]:pos_indices[3]+1].transpose(1,0)
    dq_j4 = X2[:,vel_indices[3]:vel_indices[3]+1].transpose(1,0)
    ddq_j4 = X2[:,acc_indices[3]:acc_indices[3]+1].transpose(1,0)
    q_i5 = X1[:,pos_indices[4]:pos_indices[4]+1]
    dq_i5 = X1[:,vel_indices[4]:vel_indices[4]+1]
    ddq_i5 = X1[:,acc_indices[4]:acc_indices[4]+1]
    q_j5 = X2[:,pos_indices[4]:pos_indices[4]+1].transpose(1,0)
    dq_j5 = X2[:,vel_indices[4]:vel_indices[4]+1].transpose(1,0)
    ddq_j5 = X2[:,acc_indices[4]:acc_indices[4]+1].transpose(1,0)

    sigma_kin_v_1_1 = sigma_kin_vel_list[0][0]
    sigma_kin_p_1_1_s = sigma_kin_pos_list[0][0]
    sigma_kin_p_1_1_c = sigma_kin_pos_list[0][1]
    sigma_kin_p_1_1_off = sigma_kin_pos_list[0][2]
    sigma_pot_1_s = sigma_pot_list[0][0]
    sigma_pot_1_c = sigma_pot_list[0][1]
    sigma_pot_1_off = sigma_pot_list[0][2]
    sigma_kin_v_2_1 = sigma_kin_vel_list[1][0]
    sigma_kin_p_2_1_s = sigma_kin_pos_list[1][0]
    sigma_kin_p_2_1_c = sigma_kin_pos_list[1][1]
    sigma_kin_p_2_1_off = sigma_kin_pos_list[1][2]
    sigma_kin_v_2_2 = sigma_kin_vel_list[1][1]
    sigma_kin_p_2_2_s = sigma_kin_pos_list[2][0]
    sigma_kin_p_2_2_c = sigma_kin_pos_list[2][1]
    sigma_kin_p_2_2_off = sigma_kin_pos_list[2][2]
    sigma_pot_2_s = sigma_pot_list[1][0]
    sigma_pot_2_c = sigma_pot_list[1][1]
    sigma_pot_2_off = sigma_pot_list[1][2]
    sigma_kin_v_3_1 = sigma_kin_vel_list[2][0]
    sigma_kin_p_3_1_s = sigma_kin_pos_list[3][0]
    sigma_kin_p_3_1_c = sigma_kin_pos_list[3][1]
    sigma_kin_p_3_1_off = sigma_kin_pos_list[3][2]
    sigma_kin_v_3_2 = sigma_kin_vel_list[2][1]
    sigma_kin_p_3_2_s = sigma_kin_pos_list[4][0]
    sigma_kin_p_3_2_c = sigma_kin_pos_list[4][1]
    sigma_kin_p_3_2_off = sigma_kin_pos_list[4][2]
    sigma_kin_v_3_3 = sigma_kin_vel_list[2][2]
    sigma_kin_p_3_3_s = sigma_kin_pos_list[5][0]
    sigma_kin_p_3_3_c = sigma_kin_pos_list[5][1]
    sigma_kin_p_3_3_off = sigma_kin_pos_list[5][2]
    sigma_pot_3_s = sigma_pot_list[2][0]
    sigma_pot_3_c = sigma_pot_list[2][1]
    sigma_pot_3_off = sigma_pot_list[2][2]
    sigma_kin_v_4_1 = sigma_kin_vel_list[3][0]
    sigma_kin_p_4_1_s = sigma_kin_pos_list[6][0]
    sigma_kin_p_4_1_c = sigma_kin_pos_list[6][1]
    sigma_kin_p_4_1_off = sigma_kin_pos_list[6][2]
    sigma_kin_v_4_2 = sigma_kin_vel_list[3][1]
    sigma_kin_p_4_2_s = sigma_kin_pos_list[7][0]
    sigma_kin_p_4_2_c = sigma_kin_pos_list[7][1]
    sigma_kin_p_4_2_off = sigma_kin_pos_list[7][2]
    sigma_kin_v_4_3 = sigma_kin_vel_list[3][2]
    sigma_kin_p_4_3_s = sigma_kin_pos_list[8][0]
    sigma_kin_p_4_3_c = sigma_kin_pos_list[8][1]
    sigma_kin_p_4_3_off = sigma_kin_pos_list[8][2]
    sigma_kin_v_4_4 = sigma_kin_vel_list[3][3]
    sigma_kin_p_4_4_s = sigma_kin_pos_list[9][0]
    sigma_kin_p_4_4_c = sigma_kin_pos_list[9][1]
    sigma_kin_p_4_4_off = sigma_kin_pos_list[9][2]
    sigma_pot_4_s = sigma_pot_list[3][0]
    sigma_pot_4_c = sigma_pot_list[3][1]
    sigma_pot_4_off = sigma_pot_list[3][2]
    sigma_kin_v_5_1 = sigma_kin_vel_list[4][0]
    sigma_kin_p_5_1_s = sigma_kin_pos_list[10][0]
    sigma_kin_p_5_1_c = sigma_kin_pos_list[10][1]
    sigma_kin_p_5_1_off = sigma_kin_pos_list[10][2]
    sigma_kin_v_5_2 = sigma_kin_vel_list[4][1]
    sigma_kin_p_5_2_s = sigma_kin_pos_list[11][0]
    sigma_kin_p_5_2_c = sigma_kin_pos_list[11][1]
    sigma_kin_p_5_2_off = sigma_kin_pos_list[11][2]
    sigma_kin_v_5_3 = sigma_kin_vel_list[4][2]
    sigma_kin_p_5_3_s = sigma_kin_pos_list[12][0]
    sigma_kin_p_5_3_c = sigma_kin_pos_list[12][1]
    sigma_kin_p_5_3_off = sigma_kin_pos_list[12][2]
    sigma_kin_v_5_4 = sigma_kin_vel_list[4][3]
    sigma_kin_p_5_4_s = sigma_kin_pos_list[13][0]
    sigma_kin_p_5_4_c = sigma_kin_pos_list[13][1]
    sigma_kin_p_5_4_off = sigma_kin_pos_list[13][2]
    sigma_kin_v_5_5 = sigma_kin_vel_list[4][4]
    sigma_kin_p_5_5_s = sigma_kin_pos_list[14][0]
    sigma_kin_p_5_5_c = sigma_kin_pos_list[14][1]
    sigma_kin_p_5_5_off = sigma_kin_pos_list[14][2]
    sigma_pot_5_s = sigma_pot_list[4][0]
    sigma_pot_5_c = sigma_pot_list[4][1]
    sigma_pot_5_off = sigma_pot_list[4][2]

    
    x0 = dq_i1**2
    x1 = sigma_kin_v_1_1**2
    x2 = torch.sin(q_j1)
    x3 = torch.cos(q_i1)
    x4 = sigma_kin_p_1_1_c*x3
    x5 = torch.cos(q_j1)
    x6 = torch.sin(q_i1)
    x7 = sigma_kin_p_1_1_s*x6
    x8 = sigma_kin_p_1_1_off + x2*x7 + x4*x5
    x9 = x1*x8*(x2*x4 - x5*x7)
    x10 = torch.cos(q_i2)
    x11 = torch.cos(q_j2)
    x12 = x10*x11
    x13 = torch.sin(q_i2)
    x14 = torch.sin(q_j2)
    x15 = x13*x14
    x16 = sigma_kin_p_2_2_c*x12 + sigma_kin_p_2_2_off + sigma_kin_p_2_2_s*x15
    x17 = x16**2
    x18 = sigma_kin_p_2_1_c*x3
    x19 = sigma_kin_p_2_1_s*x6
    x20 = sigma_kin_p_2_1_off + x18*x5 + x19*x2
    x21 = x17*x20*(x18*x2 - x19*x5)
    x22 = dq_i1*dq_j1
    x23 = dq_i2*dq_j2
    x24 = sigma_kin_v_2_1*x22 + sigma_kin_v_2_2*x23
    x25 = 2*x24**2
    x26 = sigma_pot_1_c*x3
    x27 = sigma_pot_1_s*x6
    x28 = sigma_pot_2_c*x12 + sigma_pot_2_off + sigma_pot_2_s*x15
    x29 = torch.cos(q_i3)
    x30 = torch.cos(q_j3)
    x31 = x29*x30
    x32 = torch.sin(q_i3)
    x33 = torch.sin(q_j3)
    x34 = x32*x33
    x35 = sigma_pot_3_c*x31 + sigma_pot_3_off + sigma_pot_3_s*x34
    x36 = torch.cos(q_i4)
    x37 = torch.cos(q_j4)
    x38 = x36*x37
    x39 = torch.sin(q_i4)
    x40 = torch.sin(q_j4)
    x41 = x39*x40
    x42 = sigma_pot_4_c*x38 + sigma_pot_4_off + sigma_pot_4_s*x41
    x43 = torch.cos(q_i5)
    x44 = torch.cos(q_j5)
    x45 = x43*x44
    x46 = torch.sin(q_i5)
    x47 = torch.sin(q_j5)
    x48 = x46*x47
    x49 = sigma_pot_5_c*x45 + sigma_pot_5_off + sigma_pot_5_s*x48
    x50 = 1.0*x35*x42*x49
    x51 = sigma_kin_p_3_1_c*x3
    x52 = sigma_kin_p_3_1_s*x6
    x53 = sigma_kin_p_3_1_off + x2*x52 + x5*x51
    x54 = sigma_kin_p_3_2_c*x12 + sigma_kin_p_3_2_off + sigma_kin_p_3_2_s*x15
    x55 = x54**2
    x56 = sigma_kin_p_3_3_c*x31 + sigma_kin_p_3_3_off + sigma_kin_p_3_3_s*x34
    x57 = x56**2
    x58 = x55*x57
    x59 = x53*x58*(x2*x51 - x5*x52)
    x60 = dq_i3*dq_j3
    x61 = sigma_kin_v_3_1*x22 + sigma_kin_v_3_2*x23 + sigma_kin_v_3_3*x60
    x62 = 2*x61**2
    x63 = dq_i5*sigma_kin_v_5_5
    x64 = 2*ddq_j5
    x65 = x63*x64
    x66 = sigma_kin_p_5_1_c*x3
    x67 = sigma_kin_p_5_1_s*x6
    x68 = sigma_kin_p_5_1_off + x2*x67 + x5*x66
    x69 = x68**2
    x70 = sigma_kin_p_5_2_c*x12 + sigma_kin_p_5_2_off + sigma_kin_p_5_2_s*x15
    x71 = x70**2
    x72 = sigma_kin_p_5_3_c*x31 + sigma_kin_p_5_3_off + sigma_kin_p_5_3_s*x34
    x73 = x72**2
    x74 = sigma_kin_p_5_4_c*x38 + sigma_kin_p_5_4_off + sigma_kin_p_5_4_s*x41
    x75 = x74**2
    x76 = sigma_kin_p_5_5_c*x45 + sigma_kin_p_5_5_off + sigma_kin_p_5_5_s*x48
    x77 = x76**2
    x78 = x71*x73*x75*x77
    x79 = x69*x78
    x80 = sigma_kin_v_5_1*x79
    x81 = dq_i1*x80
    x82 = sigma_kin_p_4_1_c*x3
    x83 = sigma_kin_p_4_1_s*x6
    x84 = sigma_kin_p_4_1_off + x2*x83 + x5*x82
    x85 = sigma_kin_p_4_2_c*x12 + sigma_kin_p_4_2_off + sigma_kin_p_4_2_s*x15
    x86 = x85**2
    x87 = sigma_kin_p_4_3_c*x31 + sigma_kin_p_4_3_off + sigma_kin_p_4_3_s*x34
    x88 = x87**2
    x89 = sigma_kin_p_4_4_c*x38 + sigma_kin_p_4_4_off + sigma_kin_p_4_4_s*x41
    x90 = x89**2
    x91 = x86*x88*x90
    x92 = x84*x91*(x2*x82 - x5*x83)
    x93 = dq_i4*dq_j4
    x94 = sigma_kin_v_4_1*x22 + sigma_kin_v_4_2*x23 + sigma_kin_v_4_3*x60 + sigma_kin_v_4_4*x93
    x95 = 2*x94**2
    x96 = x68*x78*(x2*x66 - x5*x67)
    x97 = dq_j5*x63
    x98 = sigma_kin_v_5_1*x22 + sigma_kin_v_5_2*x23 + sigma_kin_v_5_3*x60 + sigma_kin_v_5_4*x93 + x97
    x99 = 2*x98**2
    x100 = 4*dq_i1
    x101 = sigma_kin_v_5_1*x98
    x102 = x69*x71*x73
    x103 = x101*x102
    x104 = x43*x47
    x105 = x44*x46
    x106 = x75*x76*(sigma_kin_p_5_5_c*x104 - sigma_kin_p_5_5_s*x105)
    x107 = 2*ddq_j4
    x108 = dq_i4*x107
    x109 = x84**2
    x110 = x109*x91
    x111 = sigma_kin_v_4_1*x110
    x112 = dq_i1*(sigma_kin_v_4_4*x111 + sigma_kin_v_5_4*x80)
    x113 = 2*ddq_j3
    x114 = dq_i3*x113
    x115 = x53**2
    x116 = x115*x58
    x117 = sigma_kin_v_3_1*x116
    x118 = dq_i1*(sigma_kin_v_3_3*x117 + sigma_kin_v_4_3*x111 + sigma_kin_v_5_3*x80)
    x119 = sigma_kin_v_4_1*x94
    x120 = x36*x40
    x121 = x37*x39
    x122 = x109*x86*x88*x89*(sigma_kin_p_4_4_c*x120 - sigma_kin_p_4_4_s*x121)
    x123 = x74*x77*(sigma_kin_p_5_4_c*x120 - sigma_kin_p_5_4_s*x121)
    x124 = 2*ddq_j2
    x125 = dq_i2*x124
    x126 = x20**2
    x127 = x126*x17
    x128 = dq_i1*(sigma_kin_v_2_1*sigma_kin_v_2_2*x127 + sigma_kin_v_3_2*x117 + sigma_kin_v_4_2*x111 + sigma_kin_v_5_2*x80)
    x129 = 2*ddq_j1
    x130 = sigma_kin_v_3_1*x61
    x131 = x115*x130
    x132 = x29*x33
    x133 = x30*x32
    x134 = x55*x56*(sigma_kin_p_3_3_c*x132 - sigma_kin_p_3_3_s*x133)
    x135 = x109*x90
    x136 = x119*x135
    x137 = x86*x87*(sigma_kin_p_4_3_c*x132 - sigma_kin_p_4_3_s*x133)
    x138 = x69*x75*x77
    x139 = x101*x138
    x140 = x71*x72*(sigma_kin_p_5_3_c*x132 - sigma_kin_p_5_3_s*x133)
    x141 = sigma_kin_v_2_1*x24
    x142 = x10*x14
    x143 = x11*x13
    x144 = x126*x16*(sigma_kin_p_2_2_c*x142 - sigma_kin_p_2_2_s*x143)
    x145 = x54*x57*(sigma_kin_p_3_2_c*x142 - sigma_kin_p_3_2_s*x143)
    x146 = x85*x88*(sigma_kin_p_4_2_c*x142 - sigma_kin_p_4_2_s*x143)
    x147 = x70*x73*(sigma_kin_p_5_2_c*x142 - sigma_kin_p_5_2_s*x143)
    x148 = sigma_pot_1_off + x2*x27 + x26*x5
    x149 = x115*x145
    x150 = sigma_kin_v_5_2*x79
    x151 = x135*x146
    x152 = x138*x147
    x153 = 4*dq_i2
    x154 = sigma_kin_v_5_2*x98
    x155 = x102*x106
    x156 = dq_j5*x155
    x157 = sigma_kin_v_4_2*x110
    x158 = sigma_kin_v_4_4*x157 + sigma_kin_v_5_4*x150
    x159 = sigma_kin_v_3_2*sigma_kin_v_3_3*x116 + sigma_kin_v_4_3*x157 + sigma_kin_v_5_3*x150
    x160 = sigma_kin_v_4_2*x94
    x161 = x102*x123
    x162 = sigma_kin_v_3_2*x61
    x163 = x115*x162
    x164 = x135*x160
    x165 = x138*x154
    x166 = sigma_kin_v_2_2*x24
    x167 = 1.0*x148*x28*x49
    x168 = x115*x134
    x169 = sigma_kin_v_5_3*x79
    x170 = x135*x137
    x171 = x138*x140
    x172 = 4*dq_i3
    x173 = sigma_kin_v_5_3*x98
    x174 = sigma_kin_v_4_3*sigma_kin_v_4_4*x110 + sigma_kin_v_5_4*x169
    x175 = sigma_kin_v_4_3*x94
    x176 = sigma_kin_v_3_3*x61
    x177 = x64*x79
    x178 = sigma_kin_v_5_4*x63
    x179 = 4*dq_i4
    x180 = sigma_kin_v_5_4*x98
    x181 = sigma_kin_v_4_4*x94
    x182 = 4*x98
    x183 = x182*x63
    
    K_block_list = []
    K_block_list.append(2*dq_j1**2*x0*x9 - dq_j2*x100*(x131*x145 + x136*x146 + x139*x147 + x141*x144) - dq_j3*x100*(x131*x134 + x136*x137 + x139*x140) - dq_j4*x100*(x103*x123 + x119*x122) - dq_j5*x100*x103*x106 + x0*x129*(sigma_kin_v_2_1**2*x127 + sigma_kin_v_3_1**2*x116 + sigma_kin_v_4_1**2*x110 + sigma_kin_v_5_1**2*x79 + x1*x8**2) + x108*x112 + x114*x118 + x125*x128 + x21*x25 - 4*x22*(x101*x96 + x119*x92 + x130*x59 + x141*x21 + x22*x9) + x28*x50*(x2*x26 - x27*x5) + x59*x62 + x65*x81 + x92*x95 + x96*x99)
    K_block_list.append(dq_i2**2*x124*(sigma_kin_v_2_2**2*x127 + sigma_kin_v_3_2**2*x116 + sigma_kin_v_4_2**2*x110 + sigma_kin_v_5_2**2*x79) + dq_i2*x108*x158 + dq_i2*x114*x159 + dq_i2*x128*x129 + dq_i2*x150*x65 - dq_j1*x153*(x154*x96 + x160*x92 + x162*x59 + x166*x21) - dq_j3*x153*(x134*x163 + x137*x164 + x140*x165) - dq_j4*x153*(x122*x160 + x154*x161) + x144*x25 + x148*x50*(sigma_pot_2_c*x142 - sigma_pot_2_s*x143) + x149*x62 + x151*x95 + x152*x99 - x153*x154*x156 - 4*x23*(x144*x166 + x145*x163 + x146*x164 + x147*x165))
    K_block_list.append(dq_i3**2*x113*(sigma_kin_v_3_3**2*x116 + sigma_kin_v_4_3**2*x110 + sigma_kin_v_5_3**2*x79) + dq_i3*x108*x174 + dq_i3*x118*x129 + dq_i3*x125*x159 + dq_i3*x169*x65 - dq_j1*x172*(x173*x96 + x175*x92 + x176*x59) - dq_j2*x172*(x149*x176 + x151*x175 + x152*x173) - dq_j4*x172*(x122*x175 + x161*x173) - x156*x172*x173 + x167*x42*(sigma_pot_3_c*x132 - sigma_pot_3_s*x133) + x168*x62 + x170*x95 + x171*x99 - 4*x60*(x168*x176 + x170*x175 + x171*x173))
    K_block_list.append(dq_i4**2*x107*(sigma_kin_v_4_4**2*x110 + sigma_kin_v_5_4**2*x79) + dq_i4*x112*x129 + dq_i4*x114*x174 + dq_i4*x125*x158 + dq_i4*x177*x178 - dq_j1*x179*(x180*x96 + x181*x92) - dq_j2*x179*(x151*x181 + x152*x180) - dq_j3*x179*(x170*x181 + x171*x180) + x122*x95 - x156*x179*x180 + x161*x99 + x167*x35*(sigma_pot_4_c*x120 - sigma_pot_4_s*x121) - 4*x93*(x122*x181 + x161*x180))
    K_block_list.append(dq_i5**2*sigma_kin_v_5_5**2*x177 - dq_j1*x183*x96 - dq_j2*x152*x183 - dq_j3*x171*x183 - dq_j4*x161*x183 + x108*x178*x79 + x114*x169*x63 + x125*x150*x63 + x129*x63*x81 + 1.0*x148*x28*x35*x42*(sigma_pot_5_c*x104 - sigma_pot_5_s*x105) - x155*x182*x97 + x155*x99)
    
    return K_block_list

